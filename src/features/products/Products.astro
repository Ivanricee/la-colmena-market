---
import Card from '@/components/ui/Card.astro'
import { getProducts } from './products.api'
import type { Product } from './products.model'

const { productos, errorMessage } = (await getProducts()) as {
  productos: Product[]
  errorMessage: string
}
console.log({ productos, errorMessage })
---

{
  errorMessage ? (
    <section>
      <h1>Error</h1>
      <p>{errorMessage}</p>
    </section>
  ) : (
    <section>
      <h1>Productos</h1>
      <ul class="grid auto-rows-[30rem] grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
        {productos.map((product) => (
          <li class="group shadow-honey-dark/30 @container h-full overflow-hidden rounded-lg transition-all duration-500 hover:scale-[1.03] hover:shadow-2xl">
            <Card
              class="from-card flex h-full flex-col bg-linear-to-t to-transparent @sm:flex-row @sm:flex-nowrap"
              href={`/product/${product.id}`}
            >
              <div class="h-full flex-1">
                <div class="h-7/12 bg-blue-400 @3xs:bg-yellow-300">
                  {product.image.map((image) => (
                    <img
                      class="drop-shadow-honey-dark/20 group-hover:drop-shadow-honey-dark/30 relative h-full w-full object-cover drop-shadow-xl transition-[shadow_transform] duration-700 group-hover:scale-105 group-hover:drop-shadow-2xl"
                      src={image.url}
                      alt=""
                    />
                  ))}
                </div>
                <div class="flex h-5/12 flex-col justify-between space-y-3 overflow-hidden pt-8 leading-normal">
                  <div>
                    <h4 class="text-foreground mb-2 line-clamp-1 text-lg font-semibold">
                      {product.title}
                    </h4>
                    <div
                      class="text-muted-foreground line-clamp-3 text-sm text-pretty @sm:text-balance"
                      set:html={product.description.html}
                    />
                  </div>
                  <div class="flex flex-nowrap">
                    <p class="flex items-baseline gap-2">
                      <span class="from-primary bg-linear-to-r to-orange-400 bg-clip-text text-2xl font-bold text-transparent">
                        ${product.price}
                      </span>
                      {product.previousPrice && (
                        <span class="text-muted-foreground text-sm line-through">
                          ${product.previousPrice}
                        </span>
                      )}
                    </p>
                  </div>
                </div>
              </div>
            </Card>
          </li>
        ))}
      </ul>
    </section>
  )
}
<h4>deberian aparecer los productos aquji</h4>
