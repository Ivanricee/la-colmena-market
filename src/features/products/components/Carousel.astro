---
import { Icon } from 'astro-icon/components'
import { Image } from '../products.model'

interface Props {
  images: Image[] | []
}
const { images } = Astro.props
console.log(images)
const getImg = (image: Image) => {
  const {version, public_id, format} = image
const url = `https://res.cloudinary.com/ivanrice-c/image/upload/ar_3:4,c_pad,dpr_1.0,g_center,q_auto,b_auto/v${version}/${public_id}.${format}`
return url
//https://res.cloudinary.com/ivanrice-c/image/upload/v1764367765/Frontend/la%20colmena%20market/raw_honey_zra8zn.png
}
---

<div id="indicators-carousel" class="relative w-full h-full overflow-hidden -top-3" data-carousel="static">
  <!-- Carousel wrapper -->
  <div class="rounded-base relative h-full">
    {
      images.length > 0 ? (
        images.map((image, index) => (
          <div class="hidden duration-700 ease-in-out" data-carousel-item={index === 0 ? "active" : ""}>
            <img
              src={getImg(image)}
              class:list={[
                  'drop-shadow-honey-dark/50 h-full w-full',
                  'md:-translate-y-6 -translate-y-3 md:pb-6 object-contain object-top drop-shadow-lg',
                ]}
              alt={`Product image ${index + 1}`}
            />
          </div>
        ))
      ) : (
        <>
          <!-- Fallback items if no images -->
          <div class="hidden duration-700 ease-in-out" data-carousel-item="active">
            <img
              src="/docs/images/carousel/carousel-1.svg"
              class="absolute top-1/2 left-1/2 block w-full -translate-x-1/2 -translate-y-1/2"
              alt="..."
            />
          </div>
        </>
      )
    }
  </div>
  <!-- Slider indicators -->
  <div class="absolute md:bottom-5 bottom-0.5 left-1/2 z-30 flex -translate-x-1/2 space-x-3 rtl:space-x-reverse md:bg-secondary/50 bg-secondary/80 p-2 px-4 rounded-full border border-border/30">
    {
      images.length > 0 ? (
        images.map((_, index) => (
          <button
            type="button"
            class:list={["rounded-base h-3 w-3 md:h-3.5 md:w-3.5 transition-colors",
            "aria-current:bg-muted-foreground ",
            "aria-[current=false]:bg-background/75 aria-[current=false]:hover:bg-muted-foreground/50"]}
            aria-current={index === 0 ? "true" : "false"}
            aria-label={`Slide ${index + 1}`}
            data-carousel-slide-to={index}></button>
        ))
      ) : (
        <button
          type="button"
          class:list={["rounded-base h-3 w-3 md:h-3.5 md:w-3.5 transition-colors",
            "aria-current:bg-muted-foreground ",
            "aria-[current=false]:bg-background/75 aria-[current=false]:hover:bg-muted-foreground/50"]}
          aria-current="true"
          aria-label="Slide 1"
          data-carousel-slide-to="0"></button>
      )
    }

  </div>
  <!-- Slider controls -->
  <button
    type="button"
    class="group absolute start-0 top-0 z-30 flex h-full cursor-pointer items-center justify-center px-4 focus:outline-none"
    data-carousel-prev
  >
    <span
      class="rounded-base inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center bg-secondary/50 group-hover:bg-secondary group-focus:ring-4 group-focus:ring-ring group-focus:outline-none border border-border/50"
    >
      <Icon name="lucide:chevron-left" size={24} />
      <span class="sr-only">Anterior</span>
    </span>
  </button>
  <button
    type="button"
    class="group absolute end-0 top-0 z-30 flex h-full cursor-pointer items-center justify-center px-4 focus:outline-none"
    data-carousel-next
  >
    <span
      class="rounded-base inline-flex h-11 w-11 md:h-12 md:w-12 items-center justify-center bg-secondary/50 group-hover:bg-secondary group-focus:ring-4 group-focus:ring-ring group-focus:outline-none border border-border/50"
    >
      <Icon name="lucide:chevron-right" size={24} />
      <span class="sr-only">Siguiente</span>
    </span>
  </button>
</div>
